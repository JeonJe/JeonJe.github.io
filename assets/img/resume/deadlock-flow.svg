<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 5 320 420">
  <style>
    .title { font: 600 13px 'Roboto', sans-serif; fill: #444; letter-spacing: 0.5px; }
    .label { font: 500 11px 'Roboto', sans-serif; fill: #555; }
    .box-before { fill: #fff; stroke: #e0e0e0; stroke-width: 1.5; rx: 6; }
    .box-after { fill: #fff; stroke: #e0e0e0; stroke-width: 1.5; rx: 6; }
    .lock { fill: #f8f9fa; stroke: #ccc; stroke-width: 1.5; rx: 3; }
    .lock-problem { fill: #f5f5f5; stroke: #999; stroke-width: 2; rx: 3; }
    .lock-solution { fill: #f0f0f0; stroke: #666; stroke-width: 2; rx: 3; }
    .arrow { stroke: #888; stroke-width: 2; fill: none; }
    .conflict { stroke: #999; stroke-width: 2; stroke-dasharray: 3,3; }
    .badge-problem { fill: #999; rx: 4; }
    .badge-success { fill: #555; rx: 4; }
    .badge-text { font: 600 10px 'Roboto', sans-serif; fill: #fff; }
    .note { font: 400 10px 'Roboto', sans-serif; fill: #888; }
  </style>

  <!-- Before Section -->
  <rect x="20" y="15" width="300" height="130" class="box-before"/>
  <text x="170" y="38" text-anchor="middle" class="title">BEFORE: 순서 불일치</text>

  <!-- 트랜잭션 레이블 -->
  <text x="80" y="52" text-anchor="middle" class="label">TxA</text>
  <text x="240" y="52" text-anchor="middle" class="label">TxB</text>

  <!-- TxA: 피부과 N 획득 -->
  <rect x="40" y="62" width="80" height="32" class="lock-problem"/>
  <text x="80" y="82" text-anchor="middle" class="label">피부과 N</text>

  <!-- TxB: 소아과 Y 획득 -->
  <rect x="200" y="62" width="80" height="32" class="lock-problem"/>
  <text x="240" y="82" text-anchor="middle" class="label">소아과 Y</text>

  <!-- 교차 대기 화살표 (데드락) -->
  <path d="M 125 78 Q 160 60 195 78" class="arrow" stroke-dasharray="4,3"/>
  <polygon points="190,74 200,78 192,82" fill="#888"/>
  <text x="160" y="55" text-anchor="middle" class="note">대기</text>

  <path d="M 195 86 Q 160 105 125 86" class="arrow" stroke-dasharray="4,3"/>
  <polygon points="130,82 120,86 128,90" fill="#888"/>
  <text x="160" y="118" text-anchor="middle" class="note">대기</text>

  <!-- Arrow Down -->
  <line x1="170" y1="150" x2="170" y2="195" stroke="#bbb" stroke-width="2" stroke-dasharray="4,4"/>
  <polygon points="164,190 170,205 176,190" fill="#bbb"/>

  <!-- After Section -->
  <rect x="20" y="215" width="300" height="150" class="box-after"/>
  <text x="170" y="238" text-anchor="middle" class="title">AFTER: 순서 일치</text>

  <!-- 트랜잭션 레이블 -->
  <text x="80" y="252" text-anchor="middle" class="label">TxA</text>
  <text x="240" y="252" text-anchor="middle" class="label">TxB</text>

  <!-- TxA: 피부과 N → 소아과 Y (순서대로) -->
  <rect x="40" y="262" width="80" height="32" class="lock-solution"/>
  <text x="80" y="282" text-anchor="middle" class="label">피부과 N</text>

  <!-- TxB: 피부과 N → 소아과 Y (같은 순서) -->
  <rect x="200" y="262" width="80" height="32" class="lock-solution"/>
  <text x="240" y="282" text-anchor="middle" class="label">피부과 N</text>

  <!-- 순차 처리 화살표 (교차 없음) -->
  <path d="M 80 299 L 80 310" class="arrow"/>
  <polygon points="76,305 80,315 84,305" fill="#888"/>

  <path d="M 240 299 L 240 310" class="arrow"/>
  <polygon points="236,305 240,315 244,305" fill="#888"/>

  <!-- 다음 단계 -->
  <rect x="40" y="318" width="80" height="32" class="lock-solution"/>
  <text x="80" y="338" text-anchor="middle" class="label">소아과 Y</text>

  <rect x="200" y="318" width="80" height="32" class="lock-solution"/>
  <text x="240" y="338" text-anchor="middle" class="label">소아과 Y</text>

</svg>
